<!-- Generated by pkgdown: do not edit by hand -->
<!DOCTYPE html>
<html lang="en">
  <head>
  <meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<title>Apply functions to a list or vector in 'dplyr' — over • dplyover</title>


<!-- jquery -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script>
<!-- Bootstrap -->
<link href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.4.0/cerulean/bootstrap.min.css" rel="stylesheet" crossorigin="anonymous" />


<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script>

<!-- bootstrap-toc -->
<link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script>

<!-- Font Awesome icons -->
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous" />
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous" />

<!-- clipboard.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script>

<!-- headroom.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script>

<!-- pkgdown -->
<link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script>




<meta property="og:title" content="Apply functions to a list or vector in 'dplyr' — over" />
<meta property="og:description" content="over() makes it easy to create new colums inside a dplyr::mutate() or
dplyr::summarise() call by applying a function (or a set of functions) to
an atomic vector or list using a syntax similar to dplyr::across().
The main difference is that dplyr::across() transforms or creates new columns
based on existing ones, while over() can create new columns based on a
vector or list to which it will apply one or several functions.
Whereas dplyr::across() allows tidy-selection helpers to select columns,
over() provides its own helper functions to select strings or values based
on either (1) values of specified columns or (2) column names. See the
examples below and the vignette(&quot;why_dplyover&quot;) for more details." />




<!-- mathjax -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script>

<!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->



  </head>

  <body data-spy="scroll" data-target="#toc">
    <div class="container template-reference-topic">
      <header>
      <div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">dplyover</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">0.0.7.9000</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        
      </ul>
      <ul class="nav navbar-nav navbar-right">
        <li>
  <a href="../index.html">
    <span class="fas fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="../articles/why_dplyover.html">Why dplyover?</a>
    </li>
    <li>
      <a href="../articles/performance.html">Performance and Compability</a>
    </li>
  </ul>
</li>
<li>
  <a href="../news/index.html">News</a>
</li>
<li>
  <a href="https://twitter.com/timteafan">
    <span class="fab fa-twitter"></span>
     
  </a>
</li>
<li>
  <a href="https://github.com/TimTeaFan/dplyover/">
    <span class="fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
      
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header>

<div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Apply functions to a list or vector in 'dplyr'</h1>
    <small class="dont-index">Source: <a href='https://github.com/TimTeaFan/dplyover/blob/master/R/over.R'><code>R/over.R</code></a></small>
    <div class="hidden name"><code>over.Rd</code></div>
    </div>

    <div class="ref-description">
    <p><code>over()</code> makes it easy to create new colums inside a <code><a href='https://dplyr.tidyverse.org/reference/mutate.html'>dplyr::mutate()</a></code> or
<code><a href='https://dplyr.tidyverse.org/reference/summarise.html'>dplyr::summarise()</a></code> call by applying a function (or a set of functions) to
an atomic vector or list using a syntax similar to <code><a href='https://dplyr.tidyverse.org/reference/across.html'>dplyr::across()</a></code>.
The main difference is that <code><a href='https://dplyr.tidyverse.org/reference/across.html'>dplyr::across()</a></code> transforms or creates new columns
based on existing ones, while <code>over()</code> can create new columns based on a
vector or list to which it will apply one or several functions.
Whereas <code><a href='https://dplyr.tidyverse.org/reference/across.html'>dplyr::across()</a></code> allows <code>tidy-selection</code> helpers to select columns,
<code>over()</code> provides its own helper functions to select strings or values based
on either (1) values of specified columns or (2) column names. See the
examples below and the <code><a href='../articles/why_dplyover.html'>vignette("why_dplyover")</a></code> for more details.</p>
    </div>

    <pre class="usage"><span class='fu'>over</span><span class='op'>(</span><span class='va'>.x</span>, <span class='va'>.fns</span>, <span class='va'>...</span>, .names <span class='op'>=</span> <span class='cn'>NULL</span>, .names_fn <span class='op'>=</span> <span class='cn'>NULL</span><span class='op'>)</span></pre>

    <h2 class="hasAnchor" id="arguments"><a class="anchor" href="#arguments"></a>Arguments</h2>
    <table class="ref-arguments">
    <colgroup><col class="name" /><col class="desc" /></colgroup>
    <tr>
      <th>.x</th>
      <td><p>An atomic vector or list to apply functions to. Alternatively a
&lt;<code><a href='selection_helpers.html'>selection helper</a></code>&gt; can be used to create
a vector.</p></td>
    </tr>
    <tr>
      <th>.fns</th>
      <td><p>Functions to apply to each of the elements in <code>.x</code>. For
functions that expect variable names as input, the selected strings need to
be turned into symbols and evaluated. <code>dplyrover</code> comes with a genuine helper
function that evaluates strings as names <code><a href='..html'>.()</a></code>.</p>
<p>Possible values are:</p><ul>
<li><p>A function</p></li>
<li><p>A purrr-style lambda</p></li>
<li><p>A list of functions/lambdas</p></li>
</ul>

<p>For examples see the example section below.</p>
<p>Note that, unlike <code><a href='https://dplyr.tidyverse.org/reference/across.html'>across()</a></code>, <code>over()</code> does not accept <code>NULL</code> as a
value to <code>.fns</code>.</p></td>
    </tr>
    <tr>
      <th>...</th>
      <td><p>Additional arguments for the function calls in <code>.fns</code>.</p></td>
    </tr>
    <tr>
      <th>.names</th>
      <td><p>A glue specification that describes how to name the output
columns. This can use <code>{x}</code> to stand for the selected vector element, and
<code>{fn}</code> to stand for the name of the function being applied. The default
(<code>NULL</code>) is equivalent to <code>"{x}"</code> for the single function case and
<code>"{x}_{fn}"</code> for the case where a list is used for <code>.fns</code>.</p>
<p>Note that, depending on the nature of the underlying object in <code>.x</code>,
specifying <code>{x}</code> will yield different results:</p><ul>
<li><p>If <code>.x</code> is an unnamed atomic vector, <code>{x}</code> will represent each value.</p></li>
<li><p>If <code>.x</code> is a named list or atomic vector, <code>{x}</code> will represent each name.</p></li>
<li><p>If <code>.x</code> is an unnamed list, <code>{x}</code> will be the index number running from 1 to <code><a href='https://rdrr.io/r/base/length.html'>length(x)</a></code>.</p></li>
</ul>

<p>This standard behavior (interpretation of <code>{x}</code>) can be overwritten by
directly specifying:</p><ul>
<li><p><code>{x_val}</code> for <code>.x</code>'s values</p></li>
<li><p><code>{x_nm}</code> for its names</p></li>
<li><p><code>{x_idx}</code> for its index numbers</p></li>
</ul>

<p>Alternatively, a character vector of length equal to the number of columns to
be created can be supplied to <code>.names</code>. Note that in this case, the glue
specification described above is not supported.</p></td>
    </tr>
    <tr>
      <th>.names_fn</th>
      <td><p>Optionally, a function that is applied after the glue
specification in <code>.names</code> has been evaluated. This is, for example, helpful
in case the resulting names need to be further cleaned or trimmed.</p></td>
    </tr>
    </table>

    <h2 class="hasAnchor" id="value"><a class="anchor" href="#value"></a>Value</h2>

    <p>A tibble with one column for each element in <code>.x</code> and each function in <code>.fns</code>.</p>
    <h2 class="hasAnchor" id="note"><a class="anchor" href="#note"></a>Note</h2>

    

<p>Similar to <code><a href='https://dplyr.tidyverse.org/reference/across.html'>dplyr::across()</a></code> <code>over()</code> works only inside dplyr verbs.</p>
    <h2 class="hasAnchor" id="examples"><a class="anchor" href="#examples"></a>Examples</h2>

    


<p>It has two main use cases. They differ in how the elements in <code>.x</code>
are used. Let's first attach <code>dplyr</code>:<div class="r"></p><pre><span class='kw'><a href='https://rdrr.io/r/base/library.html'>library</a></span><span class='op'>(</span><span class='va'><a href='https://dplyr.tidyverse.org'>dplyr</a></span><span class='op'>)</span>

<span class='co'># For better printing</span>
<span class='va'>iris</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://tibble.tidyverse.org/reference/as_tibble.html'>as_tibble</a></span><span class='op'>(</span><span class='va'>iris</span><span class='op'>)</span>
</pre><p></div></p><h3 class='hasAnchor' id='arguments'><a class='anchor' href='#arguments'></a>(1) The General Use Case</h3>


<p>Here the values in <code>.x</code> are used as inputs to one or more functions in <code>.fns</code>.
This is useful, when we want to create several new variables based on the same
function with varying arguments. A good example is creating a bunch of lagged
variables.<div class="r"></p><pre><span class='fu'><a href='https://tibble.tidyverse.org/reference/tibble.html'>tibble</a></span><span class='op'>(</span>x <span class='op'>=</span> <span class='fl'>1</span><span class='op'>:</span><span class='fl'>25</span><span class='op'>)</span> <span class='op'>%&gt;%</span>
  <span class='fu'><a href='https://dplyr.tidyverse.org/reference/mutate.html'>mutate</a></span><span class='op'>(</span><span class='fu'>over</span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>1</span><span class='op'>:</span><span class='fl'>3</span><span class='op'>)</span>,
              <span class='op'>~</span> <span class='fu'><a href='https://dplyr.tidyverse.org/reference/lead-lag.html'>lag</a></span><span class='op'>(</span><span class='va'>x</span>, <span class='va'>.x</span><span class='op'>)</span><span class='op'>)</span><span class='op'>)</span>
<span class='co'>#&gt; # A tibble: 25 x 4</span>
<span class='co'>#&gt;       x   `1`   `2`   `3`</span>
<span class='co'>#&gt;   &lt;int&gt; &lt;int&gt; &lt;int&gt; &lt;int&gt;</span>
<span class='co'>#&gt; 1     1    NA    NA    NA</span>
<span class='co'>#&gt; 2     2     1    NA    NA</span>
<span class='co'>#&gt; 3     3     2     1    NA</span>
<span class='co'>#&gt; 4     4     3     2     1</span>
<span class='co'>#&gt; # ... with 21 more rows</span>
</pre><p></div></p>
<p>Lets create a dummy variable for each unique value in 'Species':<div class="r"></p><pre><span class='va'>iris</span> <span class='op'>%&gt;%</span>
  <span class='fu'><a href='https://dplyr.tidyverse.org/reference/mutate.html'>mutate</a></span><span class='op'>(</span><span class='fu'>over</span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/unique.html'>unique</a></span><span class='op'>(</span><span class='va'>Species</span><span class='op'>)</span>,
             <span class='op'>~</span> <span class='fu'><a href='https://dplyr.tidyverse.org/reference/if_else.html'>if_else</a></span><span class='op'>(</span><span class='va'>Species</span> <span class='op'>==</span> <span class='va'>.x</span>, <span class='fl'>1</span>, <span class='fl'>0</span><span class='op'>)</span><span class='op'>)</span>,
         .keep <span class='op'>=</span> <span class='st'>"none"</span><span class='op'>)</span>
<span class='co'>#&gt; # A tibble: 150 x 3</span>
<span class='co'>#&gt;   setosa versicolor virginica</span>
<span class='co'>#&gt;    &lt;dbl&gt;      &lt;dbl&gt;     &lt;dbl&gt;</span>
<span class='co'>#&gt; 1      1          0         0</span>
<span class='co'>#&gt; 2      1          0         0</span>
<span class='co'>#&gt; 3      1          0         0</span>
<span class='co'>#&gt; 4      1          0         0</span>
<span class='co'>#&gt; # ... with 146 more rows</span>
</pre><p></div></p>
<p>With <code>over()</code> it is also possible to create several dummy variables with
different thresholds. We can use the <code>.names</code> argument to control the output
names:<div class="r"></p><pre><span class='va'>iris</span> <span class='op'>%&gt;%</span>
<span class='fu'><a href='https://dplyr.tidyverse.org/reference/mutate.html'>mutate</a></span><span class='op'>(</span><span class='fu'>over</span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/seq.html'>seq</a></span><span class='op'>(</span><span class='fl'>4</span>, <span class='fl'>7</span>, by <span class='op'>=</span> <span class='fl'>1</span><span class='op'>)</span>,
            <span class='op'>~</span> <span class='fu'><a href='https://dplyr.tidyverse.org/reference/if_else.html'>if_else</a></span><span class='op'>(</span><span class='va'>Sepal.Length</span> <span class='op'>&lt;</span> <span class='va'>.x</span>, <span class='fl'>1</span>, <span class='fl'>0</span><span class='op'>)</span>,
            .names <span class='op'>=</span> <span class='st'>"Sepal.Length_{x}"</span><span class='op'>)</span>,
         .keep <span class='op'>=</span> <span class='st'>"none"</span><span class='op'>)</span>
<span class='co'>#&gt; # A tibble: 150 x 4</span>
<span class='co'>#&gt;   Sepal.Length_4 Sepal.Length_5 Sepal.Length_6 Sepal.Length_7</span>
<span class='co'>#&gt;            &lt;dbl&gt;          &lt;dbl&gt;          &lt;dbl&gt;          &lt;dbl&gt;</span>
<span class='co'>#&gt; 1              0              0              1              1</span>
<span class='co'>#&gt; 2              0              1              1              1</span>
<span class='co'>#&gt; 3              0              1              1              1</span>
<span class='co'>#&gt; 4              0              1              1              1</span>
<span class='co'>#&gt; # ... with 146 more rows</span>
</pre><p></div></p>
<p>A similar approach can be used with dates. Below we loop over a date
sequence to check whether the date falls within a given start and end
date. We can use the <code>.names_fn</code> argument to clean the resulting output
names:<div class="r"></p><pre><span class='co'># some dates</span>
<span class='va'>dat_tbl</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://tibble.tidyverse.org/reference/tibble.html'>tibble</a></span><span class='op'>(</span>start <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/seq.Date.html'>seq.Date</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/as.Date.html'>as.Date</a></span><span class='op'>(</span><span class='st'>"2020-01-01"</span><span class='op'>)</span>,
                                   <span class='fu'><a href='https://rdrr.io/r/base/as.Date.html'>as.Date</a></span><span class='op'>(</span><span class='st'>"2020-01-15"</span><span class='op'>)</span>,
                                   by <span class='op'>=</span> <span class='st'>"days"</span><span class='op'>)</span>,
                  end <span class='op'>=</span> <span class='va'>start</span> <span class='op'>+</span> <span class='fl'>10</span><span class='op'>)</span>

<span class='va'>dat_tbl</span> <span class='op'>%&gt;%</span>
  <span class='fu'><a href='https://dplyr.tidyverse.org/reference/mutate.html'>mutate</a></span><span class='op'>(</span><span class='fu'>over</span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/seq.html'>seq</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/as.Date.html'>as.Date</a></span><span class='op'>(</span><span class='st'>"2020-01-01"</span><span class='op'>)</span>,
                  <span class='fu'><a href='https://rdrr.io/r/base/as.Date.html'>as.Date</a></span><span class='op'>(</span><span class='st'>"2020-01-21"</span><span class='op'>)</span>,
                  by <span class='op'>=</span> <span class='st'>"weeks"</span><span class='op'>)</span>,
              <span class='op'>~</span> <span class='va'>.x</span> <span class='op'>&gt;=</span> <span class='va'>start</span> <span class='op'>&amp;</span> <span class='va'>.x</span> <span class='op'>&lt;=</span> <span class='va'>end</span>,
              .names <span class='op'>=</span> <span class='st'>"day_{x}"</span>,
              .names_fn <span class='op'>=</span> <span class='op'>~</span> <span class='fu'><a href='https://rdrr.io/r/base/grep.html'>gsub</a></span><span class='op'>(</span><span class='st'>"-"</span>, <span class='st'>""</span>, <span class='va'>.x</span><span class='op'>)</span><span class='op'>)</span><span class='op'>)</span>
<span class='co'>#&gt; # A tibble: 15 x 5</span>
<span class='co'>#&gt;    start      end        day_20200101 day_20200108 day_20200115</span>
<span class='co'>#&gt;    &lt;date&gt;     &lt;date&gt;     &lt;lgl&gt;        &lt;lgl&gt;        &lt;lgl&gt;       </span>
<span class='co'>#&gt;  1 2020-01-01 2020-01-11 TRUE         TRUE         FALSE       </span>
<span class='co'>#&gt;  2 2020-01-02 2020-01-12 FALSE        TRUE         FALSE       </span>
<span class='co'>#&gt;  3 2020-01-03 2020-01-13 FALSE        TRUE         FALSE       </span>
<span class='co'>#&gt;  4 2020-01-04 2020-01-14 FALSE        TRUE         FALSE       </span>
<span class='co'>#&gt;  5 2020-01-05 2020-01-15 FALSE        TRUE         TRUE        </span>
<span class='co'>#&gt;  6 2020-01-06 2020-01-16 FALSE        TRUE         TRUE        </span>
<span class='co'>#&gt;  7 2020-01-07 2020-01-17 FALSE        TRUE         TRUE        </span>
<span class='co'>#&gt;  8 2020-01-08 2020-01-18 FALSE        TRUE         TRUE        </span>
<span class='co'>#&gt;  9 2020-01-09 2020-01-19 FALSE        FALSE        TRUE        </span>
<span class='co'>#&gt; 10 2020-01-10 2020-01-20 FALSE        FALSE        TRUE        </span>
<span class='co'>#&gt; 11 2020-01-11 2020-01-21 FALSE        FALSE        TRUE        </span>
<span class='co'>#&gt; 12 2020-01-12 2020-01-22 FALSE        FALSE        TRUE        </span>
<span class='co'>#&gt; 13 2020-01-13 2020-01-23 FALSE        FALSE        TRUE        </span>
<span class='co'>#&gt; 14 2020-01-14 2020-01-24 FALSE        FALSE        TRUE        </span>
<span class='co'>#&gt; 15 2020-01-15 2020-01-25 FALSE        FALSE        TRUE</span>
</pre><p></div></p>
<p><code>over()</code> can summarise data in wide format. In the example below, we want to
know for each group of customers (<code>new</code>, <code>existing</code>, <code>reactivate</code>), how much
percent of the respondents gave which rating on a five point likert scale
(<code>item1</code>). A usual approach in the tidyverse would be to use
<code>count %&gt;% group_by %&gt;% mutate</code>, which yields the same result in the usually
prefered long format. Sometimes, however, we might want this kind of summary
in the wide format, and in this case <code>over()</code> comes in handy:<div class="r"></p><pre><span class='va'>csatraw</span> <span class='op'>%&gt;%</span>
  <span class='fu'><a href='https://dplyr.tidyverse.org/reference/group_by.html'>group_by</a></span><span class='op'>(</span><span class='va'>type</span><span class='op'>)</span> <span class='op'>%&gt;%</span>
  <span class='fu'><a href='https://dplyr.tidyverse.org/reference/summarise.html'>summarise</a></span><span class='op'>(</span><span class='fu'>over</span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>1</span><span class='op'>:</span><span class='fl'>5</span><span class='op'>)</span>,
                 <span class='op'>~</span> <span class='fu'><a href='https://rdrr.io/r/base/mean.html'>mean</a></span><span class='op'>(</span><span class='va'>item1</span> <span class='op'>==</span> <span class='va'>.x</span><span class='op'>)</span><span class='op'>)</span><span class='op'>)</span>
<span class='co'>#&gt; # A tibble: 3 x 6</span>
<span class='co'>#&gt;   type          `1`   `2`   `3`   `4`    `5`</span>
<span class='co'>#&gt; * &lt;chr&gt;       &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;  &lt;dbl&gt;</span>
<span class='co'>#&gt; 1 existing   0.156  0.234 0.234 0.266 0.109 </span>
<span class='co'>#&gt; 2 new        0.0714 0.268 0.357 0.214 0.0893</span>
<span class='co'>#&gt; 3 reactivate 0.0667 0.267 0.133 0.4   0.133</span>
</pre><p></div></p>
<p>Instead of a vector we can provide a named list of vectors to calculate the
top two and bottom two categories on the fly:<div class="r"></p><pre><span class='va'>csatraw</span> <span class='op'>%&gt;%</span>
  <span class='fu'><a href='https://dplyr.tidyverse.org/reference/group_by.html'>group_by</a></span><span class='op'>(</span><span class='va'>type</span><span class='op'>)</span> <span class='op'>%&gt;%</span>
  <span class='fu'><a href='https://dplyr.tidyverse.org/reference/summarise.html'>summarise</a></span><span class='op'>(</span><span class='fu'>over</span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/list.html'>list</a></span><span class='op'>(</span>bot2 <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>1</span><span class='op'>:</span><span class='fl'>2</span><span class='op'>)</span>,
                      mid  <span class='op'>=</span> <span class='fl'>3</span>,
                      top2 <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>4</span><span class='op'>:</span><span class='fl'>5</span><span class='op'>)</span><span class='op'>)</span>,
                 <span class='op'>~</span> <span class='fu'><a href='https://rdrr.io/r/base/mean.html'>mean</a></span><span class='op'>(</span><span class='va'>item1</span> <span class='op'>%in%</span> <span class='va'>.x</span><span class='op'>)</span><span class='op'>)</span><span class='op'>)</span>
<span class='co'>#&gt; # A tibble: 3 x 4</span>
<span class='co'>#&gt;   type        bot2   mid  top2</span>
<span class='co'>#&gt; * &lt;chr&gt;      &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;</span>
<span class='co'>#&gt; 1 existing   0.391 0.234 0.375</span>
<span class='co'>#&gt; 2 new        0.339 0.357 0.304</span>
<span class='co'>#&gt; 3 reactivate 0.333 0.133 0.533</span>
</pre><p></div></p>
<p><code>over()</code> can also loop over columns of a data.frame. In the example below we
want to create four different dummy variables of <code>item1</code>: (i) the top and (ii)
bottom category as well as (iii) the top two and (iv) the bottom two categories.
We can create a lookup <code>data.frame</code> and use all columns but the first as input to
<code>over()</code>. In the function call we make use of base R's <code><a href='https://rdrr.io/r/base/match.html'>match()</a></code>, where <code>.x</code>
represents the new values and <code>recode_df[, 1]</code> refers to the old values.<div class="r"></p><pre>
<span class='va'>recode_df</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/data.frame.html'>data.frame</a></span><span class='op'>(</span>old  <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>1</span>, <span class='fl'>2</span>, <span class='fl'>3</span>, <span class='fl'>4</span>, <span class='fl'>5</span><span class='op'>)</span>,
                        top1 <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>0</span>, <span class='fl'>0</span>, <span class='fl'>0</span>, <span class='fl'>0</span>, <span class='fl'>1</span><span class='op'>)</span>,
                        top2 <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>0</span>, <span class='fl'>0</span>, <span class='fl'>0</span>, <span class='fl'>1</span>, <span class='fl'>1</span><span class='op'>)</span>,
                        bot1 <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>1</span>, <span class='fl'>0</span>, <span class='fl'>0</span>, <span class='fl'>0</span>, <span class='fl'>0</span><span class='op'>)</span>,
                        bot2 <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>1</span>, <span class='fl'>1</span>, <span class='fl'>0</span>, <span class='fl'>0</span>, <span class='fl'>0</span><span class='op'>)</span><span class='op'>)</span>

<span class='va'>csatraw</span> <span class='op'>%&gt;%</span>
  <span class='fu'><a href='https://dplyr.tidyverse.org/reference/mutate.html'>mutate</a></span><span class='op'>(</span><span class='fu'>over</span><span class='op'>(</span><span class='va'>recode_df</span><span class='op'>[</span>,<span class='op'>-</span><span class='fl'>1</span><span class='op'>]</span>,
              <span class='op'>~</span> <span class='va'>.x</span><span class='op'>[</span><span class='fu'><a href='https://rdrr.io/r/base/match.html'>match</a></span><span class='op'>(</span><span class='va'>item1</span>, <span class='va'>recode_df</span><span class='op'>[</span>, <span class='fl'>1</span><span class='op'>]</span><span class='op'>)</span><span class='op'>]</span>,
              .names <span class='op'>=</span> <span class='st'>"item1_{x}"</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>%&gt;%</span>
  <span class='fu'><a href='https://dplyr.tidyverse.org/reference/select.html'>select</a></span><span class='op'>(</span><span class='fu'><a href='https://tidyselect.r-lib.org/reference/starts_with.html'>starts_with</a></span><span class='op'>(</span><span class='st'>"item1"</span><span class='op'>)</span><span class='op'>)</span>
<span class='co'>#&gt; # A tibble: 150 x 6</span>
<span class='co'>#&gt;   item1 item1_open item1_top1 item1_top2 item1_bot1 item1_bot2</span>
<span class='co'>#&gt;   &lt;dbl&gt; &lt;chr&gt;           &lt;dbl&gt;      &lt;dbl&gt;      &lt;dbl&gt;      &lt;dbl&gt;</span>
<span class='co'>#&gt; 1     3 12                  0          0          0          0</span>
<span class='co'>#&gt; 2     2 22                  0          0          0          1</span>
<span class='co'>#&gt; 3     2 21, 22, 23          0          0          0          1</span>
<span class='co'>#&gt; 4     4 12, 13, 11          0          1          0          0</span>
<span class='co'>#&gt; # ... with 146 more rows</span>
</pre><p></div></p>
<p><code>over()</code> work nicely with comma separated values stored in character vectors.
In the example below, the colum <code>csat_open</code> contains one or more comma
separated reasons why a specific customer satisfaction rating was given.
We can easily create a column for each response category with the help of
<code>dist_values</code> - a wrapper around <code>unique</code> which can split vector elements
using a separator:<div class="r"></p><pre><span class='va'>csat</span> <span class='op'>%&gt;%</span>
  <span class='fu'><a href='https://dplyr.tidyverse.org/reference/mutate.html'>mutate</a></span><span class='op'>(</span><span class='fu'>over</span><span class='op'>(</span><span class='fu'><a href='select_values.html'>dist_values</a></span><span class='op'>(</span><span class='va'>csat_open</span>, .sep <span class='op'>=</span> <span class='st'>", "</span><span class='op'>)</span>,
              <span class='op'>~</span> <span class='fu'><a href='https://rdrr.io/r/base/integer.html'>as.integer</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/grep.html'>grepl</a></span><span class='op'>(</span><span class='va'>.x</span>, <span class='va'>csat_open</span><span class='op'>)</span><span class='op'>)</span>,
              .names <span class='op'>=</span> <span class='st'>"rsp_{x}"</span>,
              .names_fn <span class='op'>=</span> <span class='op'>~</span> <span class='fu'><a href='https://rdrr.io/r/base/grep.html'>gsub</a></span><span class='op'>(</span><span class='st'>"\\s"</span>, <span class='st'>"_"</span>, <span class='va'>.x</span><span class='op'>)</span><span class='op'>)</span>,
              .keep <span class='op'>=</span> <span class='st'>"none"</span><span class='op'>)</span> <span class='op'>%&gt;%</span> <span class='va'>glimpse</span>
<span class='co'>#&gt; Rows: 150</span>
<span class='co'>#&gt; Columns: 6</span>
<span class='co'>#&gt; $ rsp_friendly_staff &lt;int&gt; 0, 0, 0, 1, 1, 0, 0, 0, 1, 0, 1, 0, 1, 0, 0, 1, 0, 0, 0, 0, 1, 0, ...</span>
<span class='co'>#&gt; $ rsp_good_service   &lt;int&gt; 1, 0, 0, 1, 1, 0, 0, 0, 0, 0, 0, 1, 0, 0, 1, 1, 0, 0, 0, 0, 1, 0, ...</span>
<span class='co'>#&gt; $ rsp_great_product  &lt;int&gt; 0, 0, 0, 1, 1, 0, 0, 1, 0, 0, 0, 1, 1, 0, 1, 0, 0, 0, 0, 0, 1, 0, ...</span>
<span class='co'>#&gt; $ rsp_no_response    &lt;int&gt; 0, 0, 1, 0, 0, 0, 1, 1, 1, 1, 0, 0, 0, 1, 0, 0, 1, 0, 1, 0, 0, 1, ...</span>
<span class='co'>#&gt; $ rsp_too_expensive  &lt;int&gt; 0, 0, 1, 0, 0, 1, 1, 0, 1, 1, 0, 0, 0, 0, 0, 0, 1, 1, 0, 1, 0, 0, ...</span>
<span class='co'>#&gt; $ rsp_unfriendly     &lt;int&gt; 0, 1, 1, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 1, 0, 0, 1, 0, 1, 0, 0, 0, ...</span>
</pre><p></div></p>

<h3 class='hasAnchor' id='arguments'><a class='anchor' href='#arguments'></a>(2) A Very Specific Use Case</h3>


<p>Here strings are supplied to <code>.x</code> to construct column names (sharing the
same stem). This allows us to dynamically use more than one column in the
function calls in <code>.fns</code>. To work properly, the strings need to be
turned into symbols and evaluated. For this dplyover provides a genuine
helper function <code><a href='..html'>.()</a></code> that evaluates strings and helps to declutter the
otherwise rather verbose code. <code><a href='..html'>.()</a></code> supports glue syntax and takes a string
as argument.</p>
<p>Below are a few examples using two colums in the function calls in <code>.fns</code>.
For the two column case <code><a href='across2.html'>across2()</a></code> provides a more intuitive API that is
closer to the original <code><a href='https://dplyr.tidyverse.org/reference/across.html'>dplyr::across</a></code>. Using <code><a href='..html'>.()</a></code> inside <code>over</code> is really
useful for cases with more than two columns.</p>
<p>Consider the following example of a purrr-style formula in <code>.fns</code> using <code><a href='..html'>.()</a></code>:<div class="r"></p><pre><span class='va'>iris</span> <span class='op'>%&gt;%</span>
  <span class='fu'><a href='https://dplyr.tidyverse.org/reference/mutate.html'>mutate</a></span><span class='op'>(</span><span class='fu'>over</span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>"Sepal"</span>, <span class='st'>"Petal"</span><span class='op'>)</span>,
              <span class='op'>~</span> <span class='fu'><a href='..html'>.</a></span><span class='op'>(</span><span class='st'>"{.x}.Width"</span><span class='op'>)</span> <span class='op'>+</span> <span class='fu'><a href='..html'>.</a></span><span class='op'>(</span><span class='st'>"{.x}.Length"</span><span class='op'>)</span>
              <span class='op'>)</span><span class='op'>)</span>
<span class='co'>#&gt; # A tibble: 150 x 7</span>
<span class='co'>#&gt;   Sepal.Length Sepal.Width Petal.Length Petal.Width Species Sepal Petal</span>
<span class='co'>#&gt;          &lt;dbl&gt;       &lt;dbl&gt;        &lt;dbl&gt;       &lt;dbl&gt; &lt;fct&gt;   &lt;dbl&gt; &lt;dbl&gt;</span>
<span class='co'>#&gt; 1          5.1         3.5          1.4         0.2 setosa    8.6  1.60</span>
<span class='co'>#&gt; 2          4.9         3            1.4         0.2 setosa    7.9  1.60</span>
<span class='co'>#&gt; 3          4.7         3.2          1.3         0.2 setosa    7.9  1.5 </span>
<span class='co'>#&gt; 4          4.6         3.1          1.5         0.2 setosa    7.7  1.7 </span>
<span class='co'>#&gt; # ... with 146 more rows</span>
</pre><p></div></p>
<p>The above syntax is equal to the more verbose:<div class="r"></p><pre><span class='va'>iris</span> <span class='op'>%&gt;%</span>
  <span class='fu'><a href='https://dplyr.tidyverse.org/reference/mutate.html'>mutate</a></span><span class='op'>(</span><span class='fu'>over</span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>"Sepal"</span>, <span class='st'>"Petal"</span><span class='op'>)</span>,
              <span class='op'>~</span> <span class='fu'><a href='https://rdrr.io/r/base/eval.html'>eval</a></span><span class='op'>(</span><span class='fu'><a href='https://dplyr.tidyverse.org/reference/tidyeval-compat.html'>sym</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/paste.html'>paste0</a></span><span class='op'>(</span><span class='va'>.x</span>, <span class='st'>".Width"</span><span class='op'>)</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>+</span>
                <span class='fu'><a href='https://rdrr.io/r/base/eval.html'>eval</a></span><span class='op'>(</span><span class='fu'><a href='https://dplyr.tidyverse.org/reference/tidyeval-compat.html'>sym</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/paste.html'>paste0</a></span><span class='op'>(</span><span class='va'>.x</span>, <span class='st'>".Length"</span><span class='op'>)</span><span class='op'>)</span><span class='op'>)</span>
              <span class='op'>)</span><span class='op'>)</span>
<span class='co'>#&gt; # A tibble: 150 x 7</span>
<span class='co'>#&gt;   Sepal.Length Sepal.Width Petal.Length Petal.Width Species Sepal Petal</span>
<span class='co'>#&gt;          &lt;dbl&gt;       &lt;dbl&gt;        &lt;dbl&gt;       &lt;dbl&gt; &lt;fct&gt;   &lt;dbl&gt; &lt;dbl&gt;</span>
<span class='co'>#&gt; 1          5.1         3.5          1.4         0.2 setosa    8.6  1.60</span>
<span class='co'>#&gt; 2          4.9         3            1.4         0.2 setosa    7.9  1.60</span>
<span class='co'>#&gt; 3          4.7         3.2          1.3         0.2 setosa    7.9  1.5 </span>
<span class='co'>#&gt; 4          4.6         3.1          1.5         0.2 setosa    7.7  1.7 </span>
<span class='co'>#&gt; # ... with 146 more rows</span>
</pre><p></div></p>
<p><code><a href='..html'>.()</a></code> also works with anonymous functions:<div class="r"></p><pre><span class='va'>iris</span> <span class='op'>%&gt;%</span>
  <span class='fu'><a href='https://dplyr.tidyverse.org/reference/summarise.html'>summarise</a></span><span class='op'>(</span><span class='fu'>over</span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>"Sepal"</span>, <span class='st'>"Petal"</span><span class='op'>)</span>,
                <span class='kw'>function</span><span class='op'>(</span><span class='va'>x</span><span class='op'>)</span> <span class='fu'><a href='https://rdrr.io/r/base/mean.html'>mean</a></span><span class='op'>(</span><span class='fu'><a href='..html'>.</a></span><span class='op'>(</span><span class='st'>"{x}.Width"</span><span class='op'>)</span><span class='op'>)</span>
                <span class='op'>)</span><span class='op'>)</span>
<span class='co'>#&gt; # A tibble: 1 x 2</span>
<span class='co'>#&gt;   Sepal Petal</span>
<span class='co'>#&gt;   &lt;dbl&gt; &lt;dbl&gt;</span>
<span class='co'>#&gt; 1  3.06  1.20</span>
</pre><p></div></p>
<p>A named list of functions:<div class="r"></p><pre><span class='va'>iris</span> <span class='op'>%&gt;%</span>
  <span class='fu'><a href='https://dplyr.tidyverse.org/reference/mutate.html'>mutate</a></span><span class='op'>(</span><span class='fu'>over</span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>"Sepal"</span>, <span class='st'>"Petal"</span><span class='op'>)</span>,
              <span class='fu'><a href='https://rdrr.io/r/base/list.html'>list</a></span><span class='op'>(</span>product <span class='op'>=</span> <span class='op'>~</span> <span class='fu'><a href='..html'>.</a></span><span class='op'>(</span><span class='st'>"{.x}.Width"</span><span class='op'>)</span> <span class='op'>*</span> <span class='fu'><a href='..html'>.</a></span><span class='op'>(</span><span class='st'>"{.x}.Length"</span><span class='op'>)</span>,
                   sum <span class='op'>=</span> <span class='op'>~</span> <span class='fu'><a href='..html'>.</a></span><span class='op'>(</span><span class='st'>"{.x}.Width"</span><span class='op'>)</span> <span class='op'>+</span> <span class='fu'><a href='..html'>.</a></span><span class='op'>(</span><span class='st'>"{.x}.Length"</span><span class='op'>)</span><span class='op'>)</span>
                   <span class='op'>)</span>,
         .keep <span class='op'>=</span> <span class='st'>"none"</span><span class='op'>)</span>
<span class='co'>#&gt; # A tibble: 150 x 4</span>
<span class='co'>#&gt;   Sepal_product Sepal_sum Petal_product Petal_sum</span>
<span class='co'>#&gt;           &lt;dbl&gt;     &lt;dbl&gt;         &lt;dbl&gt;     &lt;dbl&gt;</span>
<span class='co'>#&gt; 1          17.8       8.6         0.280      1.60</span>
<span class='co'>#&gt; 2          14.7       7.9         0.280      1.60</span>
<span class='co'>#&gt; 3          15.0       7.9         0.26       1.5 </span>
<span class='co'>#&gt; 4          14.3       7.7         0.3        1.7 </span>
<span class='co'>#&gt; # ... with 146 more rows</span>
</pre><p></div></p>
<p>Again, use the <code>.names</code> argument to control the output names:<div class="r"></p><pre><span class='va'>iris</span> <span class='op'>%&gt;%</span>
  <span class='fu'><a href='https://dplyr.tidyverse.org/reference/mutate.html'>mutate</a></span><span class='op'>(</span><span class='fu'>over</span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>"Sepal"</span>, <span class='st'>"Petal"</span><span class='op'>)</span>,
              <span class='fu'><a href='https://rdrr.io/r/base/list.html'>list</a></span><span class='op'>(</span>product <span class='op'>=</span> <span class='op'>~</span> <span class='fu'><a href='..html'>.</a></span><span class='op'>(</span><span class='st'>"{.x}.Width"</span><span class='op'>)</span> <span class='op'>*</span> <span class='fu'><a href='..html'>.</a></span><span class='op'>(</span><span class='st'>"{.x}.Length"</span><span class='op'>)</span>,
                   sum <span class='op'>=</span> <span class='op'>~</span> <span class='fu'><a href='..html'>.</a></span><span class='op'>(</span><span class='st'>"{.x}.Width"</span><span class='op'>)</span> <span class='op'>+</span> <span class='fu'><a href='..html'>.</a></span><span class='op'>(</span><span class='st'>"{.x}.Length"</span><span class='op'>)</span><span class='op'>)</span>,
              .names <span class='op'>=</span> <span class='st'>"{fn}_{x}"</span><span class='op'>)</span>,
         .keep <span class='op'>=</span> <span class='st'>"none"</span><span class='op'>)</span>
<span class='co'>#&gt; # A tibble: 150 x 4</span>
<span class='co'>#&gt;   product_Sepal sum_Sepal product_Petal sum_Petal</span>
<span class='co'>#&gt;           &lt;dbl&gt;     &lt;dbl&gt;         &lt;dbl&gt;     &lt;dbl&gt;</span>
<span class='co'>#&gt; 1          17.8       8.6         0.280      1.60</span>
<span class='co'>#&gt; 2          14.7       7.9         0.280      1.60</span>
<span class='co'>#&gt; 3          15.0       7.9         0.26       1.5 </span>
<span class='co'>#&gt; 4          14.3       7.7         0.3        1.7 </span>
<span class='co'>#&gt; # ... with 146 more rows</span>
</pre><p></div></p>

    <h2 class="hasAnchor" id="see-also"><a class="anchor" href="#see-also"></a>See also</h2>

    <div class='dont-index'><p><code><a href='over2.html'>over2()</a></code> to apply a function to two objects.</p>
<p>All members of the &lt;<code><a href='over_across_family.html'>over-across function family</a></code>&gt;.</p></div>

  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top">
      <h2 data-toc-skip>Contents</h2>
    </nav>
  </div>
</div>


      <footer>
      <div class="copyright">
  <p>Developed by Tim Tiefenbach.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.6.1.</p>
</div>

      </footer>
   </div>

  


  </body>
</html>


