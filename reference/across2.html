<!-- Generated by pkgdown: do not edit by hand -->
<!DOCTYPE html>
<html lang="en">
  <head>
  <meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<title>Apply functions to two sets of columns simultaniously in 'dplyr' — across2 • dplyover</title>


<!-- jquery -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script>
<!-- Bootstrap -->
<link href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.4.0/cerulean/bootstrap.min.css" rel="stylesheet" crossorigin="anonymous" />


<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script>

<!-- bootstrap-toc -->
<link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script>

<!-- Font Awesome icons -->
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous" />
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous" />

<!-- clipboard.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script>

<!-- headroom.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script>

<!-- pkgdown -->
<link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script>



  <link href="../extra.css" rel="stylesheet">
  

<meta property="og:title" content="Apply functions to two sets of columns simultaniously in 'dplyr' — across2" />
<meta property="og:description" content="across2() and across2x() are variants of dplyr::across() that iterate
over two columns simultaneously. across2() loops each pair of columns in .xcols
and  .ycols over one or more functions, while across2x() loops
every combination between columns in .xcols and .ycols over one or more functions." />




<!-- mathjax -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script>

<!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->



  </head>

  <body data-spy="scroll" data-target="#toc">
    <div class="container template-reference-topic">
      <header>
      <div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">dplyover</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">0.0.7.9000</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        
      </ul>
      <ul class="nav navbar-nav navbar-right">
        <li>
  <a href="../index.html">
    <span class="fas fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../reference/index.html">
    <span class="fas fa-tools"></span>
     
    Reference
  </a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    <span class="fas fa-book-open"></span>
     
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="../articles/why_dplyover.html">Why dplyover?</a>
    </li>
    <li>
      <a href="../articles/performance.html">Performance and Compability</a>
    </li>
  </ul>
</li>
<li>
  <a href="../news/index.html">
    <span class="fas fa-clipboard-list"></span>
     
    News
  </a>
</li>
<li>
  <a href="https://twitter.com/timteafan">
    <span class="fab fa-twitter"></span>
     
  </a>
</li>
<li>
  <a href="https://github.com/TimTeaFan/dplyover/">
    <span class="fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
      
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header>

<div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Apply functions to two sets of columns simultaniously in 'dplyr'</h1>
    <small class="dont-index">Source: <a href='https://github.com/TimTeaFan/dplyover/blob/master/R/across2.R'><code>R/across2.R</code></a></small>
    <div class="hidden name"><code>across2.Rd</code></div>
    </div>

    <div class="ref-description">
    <p><code>across2()</code> and <code>across2x()</code> are variants of <code><a href='https://dplyr.tidyverse.org/reference/across.html'>dplyr::across()</a></code> that iterate
over two columns simultaneously. <code>across2()</code> loops each <em>pair of columns</em> in <code>.xcols</code>
and  <code>.ycols</code> over one or more functions, while <code>across2x()</code> loops
<em>every combination between columns</em> in <code>.xcols</code> and <code>.ycols</code> over one or more functions.</p>
    </div>

    <pre class="usage"><span class='fu'>across2</span><span class='op'>(</span><span class='va'>.xcols</span>, <span class='va'>.ycols</span>, <span class='va'>.fns</span>, <span class='va'>...</span>, .names <span class='op'>=</span> <span class='cn'>NULL</span>, .names_fn <span class='op'>=</span> <span class='cn'>NULL</span><span class='op'>)</span>

<span class='fu'>across2x</span><span class='op'>(</span>
  <span class='va'>.xcols</span>,
  <span class='va'>.ycols</span>,
  <span class='va'>.fns</span>,
  <span class='va'>...</span>,
  .names <span class='op'>=</span> <span class='cn'>NULL</span>,
  .names_fn <span class='op'>=</span> <span class='cn'>NULL</span>,
  .comb <span class='op'>=</span> <span class='st'>"all"</span>
<span class='op'>)</span></pre>

    <h2 class="hasAnchor" id="arguments"><a class="anchor" href="#arguments"></a>Arguments</h2>
    <table class="ref-arguments">
    <colgroup><col class="name" /><col class="desc" /></colgroup>
    <tr>
      <th>.xcols, .ycols</th>
      <td><p>&lt;<code><a href='https://dplyr.tidyverse.org/reference/dplyr_tidy_select.html'>tidy-select</a></code>&gt; Columns to transform.
Note that you can not select or compute upon grouping variables.</p></td>
    </tr>
    <tr>
      <th>.fns</th>
      <td><p>Functions to apply to each column in <code>.xcols</code> and <code>.ycols</code>.</p>
<p>Possible values are:</p><ul>
<li><p>A function</p></li>
<li><p>A purrr-style lambda</p></li>
<li><p>A list of functions/lambdas</p></li>
</ul>

<p>Note that <code>NULL</code> is not accepted as argument to <code>.fns</code>.</p></td>
    </tr>
    <tr>
      <th>...</th>
      <td><p>Additional arguments for the function calls in <code>.fns</code>.</p></td>
    </tr>
    <tr>
      <th>.names</th>
      <td><p>A glue specification that describes how to name the output
columns. This can use:</p><ul>
<li><p><code>{xcol}</code> to stand for the selected column name in <code>.xcols</code>,</p></li>
<li><p><code>{ycol}</code> to stand for the selected column name in <code>.ycols</code>, and</p></li>
<li><p><code>{fn}</code> to stand for the name of the function being applied.</p></li>
</ul>

<p>The default (<code>NULL</code>) is equivalent to <code>"{xcol}_{ycol}"</code> for the single function
case and <code>"{xcol}_{ycol}_{fn}"</code> for the case where a list is used for <code>.fns</code>.</p>
<p><code>across2()</code> supports two additional glue specifications: <code>{pre}</code> and <code>{suf}</code>.
They extract the common prefix or suffix of each pair of variables.</p>
<p>Alternatively to a glue specification, a character vector of length equal
to the number of columns to be created can be supplied to <code>.names</code>.
Note that in this case, the glue specification described above is not supported.</p></td>
    </tr>
    <tr>
      <th>.names_fn</th>
      <td><p>Optionally, a function that is applied after the glue
specification in <code>.names</code> has been evaluated. This is, for example, helpful,
in case the resulting names need to be further cleaned or trimmed.</p></td>
    </tr>
    <tr>
      <th>.comb</th>
      <td><p>In <code>across2x()</code> this argument allows to control which
combinations of columns are to be created. This argument only matters, if
the columns specified in <code>.xcols</code> and <code>.ycols</code> overlap to some extent.</p><ul>
<li><p><code>"all"</code>, the default, will create all pairwise combinations between columns
in <code>.xcols</code> and <code>.ycols</code> <em>including all permutations</em> (e.g.
<code>foo(column_x, column_y)</code> as well as <code>foo(column_y, column_x)</code>.</p></li>
<li><p><code>"unique"</code> will only create all unordered combinations (e.g. creates
<code>foo(column_x, column_y)</code>, while <code>foo(column_y, column_x)</code> <em>will not</em> be created)</p></li>
<li><p><code>"minimal</code> same as <code>"unique"</code> and further skips all self-matches (e.g.
<code>foo(column_x, column_x)</code> <em>will not</em> be created)</p></li>
</ul></td>
    </tr>
    </table>

    <h2 class="hasAnchor" id="value"><a class="anchor" href="#value"></a>Value</h2>

    <p><code>across2()</code> returns a tibble with one column for each pair of elements in
<code>.xcols</code> and <code>.ycols</code> combined with each function in <code>.fns</code>.</p>
<p><code>across2x()</code> returns a tibble with one column for each combination between
elements in <code>.x</code> and<code>.y</code> combined with each function in <code>.fns</code>.</p>
    <h2 class="hasAnchor" id="examples"><a class="anchor" href="#examples"></a>Examples</h2>

    


<p>For the basic functionality of <code><a href='https://dplyr.tidyverse.org/reference/across.html'>across()</a></code> please refer to the examples in
<code><a href='https://dplyr.tidyverse.org/reference/across.html'>dplyr::across()</a></code>.<div class="r"></p><pre><span class='kw'><a href='https://rdrr.io/r/base/library.html'>library</a></span><span class='op'>(</span><span class='va'><a href='https://dplyr.tidyverse.org'>dplyr</a></span><span class='op'>)</span>

<span class='co'># For better printing</span>
<span class='va'>iris</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://tibble.tidyverse.org/reference/as_tibble.html'>as_tibble</a></span><span class='op'>(</span><span class='va'>iris</span><span class='op'>)</span>
</pre><p></div></p>
<p><code>across2()</code> can be used to transfrom pairs of variables in one or more functions.
In the example below we want to calculate the product and the sum of all pairs of
'Length' and 'Width' variables. We can use <code>{pre}</code> in the glue specification in
<code>.names</code> to extract the common prefix of each pair of variables. We can further
transform the names, in the example setting them <code>tolower</code> by specifying the
<code>.names_fn</code> argument:<div class="r"></p><pre><span class='va'>iris</span> <span class='op'>%&gt;%</span>
  <span class='fu'><a href='https://dplyr.tidyverse.org/reference/mutate.html'>transmute</a></span><span class='op'>(</span><span class='fu'>across2</span><span class='op'>(</span><span class='fu'><a href='https://tidyselect.r-lib.org/reference/starts_with.html'>ends_with</a></span><span class='op'>(</span><span class='st'>"Length"</span><span class='op'>)</span>,
                    <span class='fu'><a href='https://tidyselect.r-lib.org/reference/starts_with.html'>ends_with</a></span><span class='op'>(</span><span class='st'>"Width"</span><span class='op'>)</span>,
                    .fns <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/list.html'>list</a></span><span class='op'>(</span>product <span class='op'>=</span> <span class='op'>~</span> <span class='va'>.x</span> <span class='op'>*</span> <span class='va'>.y</span>,
                                sum <span class='op'>=</span> <span class='op'>~</span> <span class='va'>.x</span> <span class='op'>+</span> <span class='va'>.y</span><span class='op'>)</span>,
                   .names <span class='op'>=</span> <span class='st'>"{pre}_{fn}"</span>,
                   .names_fn <span class='op'>=</span> <span class='va'>tolower</span><span class='op'>)</span><span class='op'>)</span>
<span class='co'>#&gt; # A tibble: 150 x 4</span>
<span class='co'>#&gt;   sepal_product sepal_sum petal_product petal_sum</span>
<span class='co'>#&gt;           &lt;dbl&gt;     &lt;dbl&gt;         &lt;dbl&gt;     &lt;dbl&gt;</span>
<span class='co'>#&gt; 1          17.8       8.6         0.280      1.60</span>
<span class='co'>#&gt; 2          14.7       7.9         0.280      1.60</span>
<span class='co'>#&gt; 3          15.0       7.9         0.26       1.5 </span>
<span class='co'>#&gt; 4          14.3       7.7         0.3        1.7 </span>
<span class='co'>#&gt; # ... with 146 more rows</span>
</pre><p></div></p>
<p><code>across2x()</code> can be used to perform calculations on each combination of variables.
In the example below we calculate the correlation between all variables in the
<code>iris</code> data set for each group. To do this, we <code>group_by</code> 'Species' and specify
the tidyselect helper <code><a href='https://tidyselect.r-lib.org/reference/everything.html'>everything()</a></code> to <code>.xcols</code> and <code>.ycols</code>.
<code>~ round(cor(.x, .y), 2)</code> gives us the correlation rounded to two digits for each
pair of variables. We trim the rahter long variables names by replacing "Sepal"
with "S", and "Petal" with "P" in the <code>.names_fn</code> argument. Finally, we are not
interested in correlations of the same column and want to avoid excessive reults
by setting the <code>.comb</code> argument to <code>"minimal"</code>.<div class="r"></p><pre><span class='va'>iris</span> <span class='op'>%&gt;%</span>
  <span class='fu'><a href='https://dplyr.tidyverse.org/reference/group_by.html'>group_by</a></span><span class='op'>(</span><span class='va'>Species</span><span class='op'>)</span> <span class='op'>%&gt;%</span>
  <span class='fu'><a href='https://dplyr.tidyverse.org/reference/summarise.html'>summarise</a></span><span class='op'>(</span><span class='fu'>across2x</span><span class='op'>(</span><span class='fu'><a href='https://tidyselect.r-lib.org/reference/everything.html'>everything</a></span><span class='op'>(</span><span class='op'>)</span>,
                     <span class='fu'><a href='https://tidyselect.r-lib.org/reference/everything.html'>everything</a></span><span class='op'>(</span><span class='op'>)</span>,
                     <span class='op'>~</span> <span class='fu'><a href='https://rdrr.io/r/base/Round.html'>round</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/stats/cor.html'>cor</a></span><span class='op'>(</span><span class='va'>.x</span>, <span class='va'>.y</span><span class='op'>)</span>, <span class='fl'>2</span><span class='op'>)</span>,
                     .names_fn <span class='op'>=</span> <span class='op'>~</span> <span class='fu'><a href='https://rdrr.io/r/base/grep.html'>gsub</a></span><span class='op'>(</span><span class='st'>"Sepal"</span>, <span class='st'>"S"</span>, <span class='va'>.x</span><span class='op'>)</span> <span class='op'>%&gt;%</span>
                                     <span class='fu'><a href='https://rdrr.io/r/base/grep.html'>gsub</a></span><span class='op'>(</span><span class='st'>"Petal"</span>, <span class='st'>"P"</span>, <span class='va'>.</span><span class='op'>)</span>,
                     .comb <span class='op'>=</span> <span class='st'>"minimal"</span><span class='op'>)</span><span class='op'>)</span>
<span class='co'>#&gt; # A tibble: 3 x 7</span>
<span class='co'>#&gt;   Species  S.Length_S.Width S.Length_P.Leng~ S.Length_P.Width S.Width_P.Length S.Width_P.Width</span>
<span class='co'>#&gt;   &lt;fct&gt;               &lt;dbl&gt;            &lt;dbl&gt;            &lt;dbl&gt;            &lt;dbl&gt;           &lt;dbl&gt;</span>
<span class='co'>#&gt; 1 setosa               0.74             0.27             0.28             0.18            0.23</span>
<span class='co'>#&gt; 2 versico~             0.53             0.75             0.55             0.56            0.66</span>
<span class='co'>#&gt; 3 virgini~             0.46             0.86             0.28             0.4             0.54</span>
<span class='co'>#&gt; # ... with 1 more variable: P.Length_P.Width &lt;dbl&gt;</span>
</pre><p></div></p>

  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top">
      <h2 data-toc-skip>Contents</h2>
    </nav>
  </div>
</div>


      <footer>
      <div class="copyright">
  <p>Developed by Tim Tiefenbach.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.6.1.</p>
</div>

      </footer>
   </div>

  


  </body>
</html>


